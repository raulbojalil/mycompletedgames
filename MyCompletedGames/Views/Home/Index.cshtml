@{ Layout = null; } <!DOCTYPE html><html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="apple-mobile-web-app-capable" content="yes" /><meta name="apple-mobile-web-app-title" content="My Completed Games"><meta name="mobile-web-app-capable" content="yes" /><meta charset="utf-8"><title>My Completed Games</title><meta name="description" content="Code Challenge"><meta name="author" content="Raúl Bojalil"><script type="text/javascript" src="Scripts/jquery.min.js"></script>
<script type="text/javascript" src="Scripts/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="Scripts/bootstrap.min.css"/>
<script type="text/javascript" src="Scripts/angular.min.js"></script>
<link rel="stylesheet" type="text/css" href="/Scripts/bootstrap-datetimepicker.css"/>
<script type="text/javascript" src="/Scripts/moment-with-locales.js"></script>
<script type="text/javascript" src="/Scripts/bootstrap-datetimepicker.js"></script>
<script type="text/javascript">var app = angular.module('myApp',[]);
var callAngularFunction = function(element, functionName, params)
{
angular.element(element).scope()[functionName](params);
angular.element(element).scope().$apply();
}
</script>
<style>.error{color:red}#nav1{margin-bottom:0}#div1{margin-top:69px}#button1{margin-bottom:20px}#text1{margin-bottom:20px}#span1{margin-right:10px}#span2{margin-right:10px}#span3{margin-right:10px}#img1{width:100px;height:100px}#div2{height:50px}#span4{cursor:pointer;font-size:23px;margin-left:10px}#span5{cursor:pointer;font-size:23px;margin-left:10px}#span6{cursor:pointer;font-size:23px;margin-left:10px}#button2{margin-bottom:20px}#span7{margin-right:10px}#span8{margin-right:10px}#span9{margin-right:10px}</style></head><body ng-app="myApp" id="appCtrl" ng-controller="appCtrl"><div class="modal fade"  id="add-game-modal" tabindex="-1" role="dialog"><div class="modal-dialog " role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">Add game</h4></div><div class="modal-body"><form name="addGameForm"><div class="form-group"><label class="control-label" for="text2">Name</label><input class="form-control" id="text2" type="text" placeholder="The name of the game, for example Doom, etc." required="required" ng-model="newGame.name" autofocus="autofocus"/></div><div class="form-group"><label class="control-label" for="newGameCompleted">Completion Date</label><input class="form-control" id="newGameCompleted" type="text" placeholder="Completion Date" required="required" ng-model="newGame.completed"/></div></form></div><div class="modal-footer"><button class="btn btn-default" data-dismiss="modal" >Cancel</button><button ng-disabled="addGameForm.$invalid" class="btn btn-success" ng-click="addGame()">Add game</button></div></div></div></div><form action="@Url.Action("LogOff", "Account")" id="logoutForm" method="post">@Html.AntiForgeryToken()</form><nav class="navbar navbar-default navbar-fixed-top" role="navigation" id="nav1"><div class="container-fluid"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#collapse1" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div class="navbar-brand">My completed games</div></div><div class="collapse navbar-collapse" id="collapse1"><ul class="nav navbar-nav navbar-right collapse in"><li class="dropdown open"><a  href="#" title="@ViewBag.Username" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="true"><span class="glyphicon glyphicon-user" style="margin-right: 7px"></span><span id="username">@ViewBag.Username</span><b style="margin-left: 10px" class="caret"></b></a><ul class="dropdown-menu"><li ><a id=tab1 title="Sign Out" href="javascript:document.getElementById('logoutForm').submit()"><span class="glyphicon glyphicon-log-out" style="margin-right: 7px"></span>Sign Out</a></li></ul></li></ul></div></div></nav><div class="container-fluid"  id="div1"><div class="row"><div class="col-sm-6"><button  class="btn btn-block btn-success" id="button1">Add new platform...</button><input class="form-control" id="text1" type="text" placeholder="Search..." ng-model="platformSearchQuery" ng-change="searchPlatform()" ng-model-options='{ debounce: 500 }'/><div class="row"><div class="col-sm-9"><nav aria-label="Page navigation"><ul class="pagination"><li ng-show="currentPlatformPage != 0" ng-class="{ disabled: currentPlatformPage == 1} "><a href="#" aria-label="Previous" ng-click="prevPlatformPage()"><span aria-hidden="true">&laquo;</span></a></li><li ng-class="{ active: page == currentPlatformPage}" ng-repeat="page in pages"><a href="#" ng-click="loadPlatforms(page)">{{ page }}</a></li><li ng-show="currentPlatformPage != 0" ng-class="{ disabled: currentPlatformPage == totalPlatformPages}"><a href="#" aria-label="Next" ng-click="nextPlatformPage()"><span aria-hidden="true">&raquo;</span></a></li></ul></nav></div><div class="col-sm-3"><div class="form-group"><label class="control-label" for="select1">Show items per page</label><select class="form-control" id="select1" ng-change="loadPlatforms(1)" ng-model="itemsPerPage"><option>3</option><option>5</option><option>10</option><option>15</option><option>20</option></select></div></div></div><div class="alert alert-info" ng-show="loadingPlatforms" role="alert"> Loading platforms, please wait...</div><div class="alert alert-danger" ng-show="platformsErrorMessage" role="alert"><span class="glyphicon glyphicon-warning-sign"  aria-hidden="true" id="span1"></span>{{ platformsErrorMessage }}</div><div class="alert alert-warning" ng-show="!platformsErrorMessage && !loadingPlatforms && platforms.length == 0 && !platformSearchQuery" role="alert"><span class="glyphicon glyphicon-warning-sign"  aria-hidden="true" id="span2"></span> You don't have any platforms, please add your first platform using the Add New Platform Button</div><div class="alert alert-warning" ng-show="!platformsErrorMessage && !loadingPlatforms && platforms.length == 0 && platformSearchQuery" role="alert"><span class="glyphicon glyphicon-warning-sign"  aria-hidden="true" id="span3"></span> No results</div><div class="panel panel-primary" ng-repeat="platform in platforms"><div class="panel-heading"><div class="panel-title">{{ platform.name }}</div></div><div class="panel-body"><img src="{{platform.image}}" class="pull-right" id="img1"/><p>Type: {{ getPlatformType(platform.type) }}</p></div><div class="panel-footer"  id="div2"><span class="glyphicon glyphicon-trash pull-right"  ng-click="deletePlatform(platform)" aria-hidden="true" id="span4"></span><span class="glyphicon glyphicon-pencil pull-right"  ng-click="editPlatform(platform)" aria-hidden="true" id="span5"></span><span class="glyphicon glyphicon-eye-open pull-right"  ng-click="loadGames(0, platform)" aria-hidden="true" id="span6"></span></div></div></div><div class="col-sm-6"><button data-toggle="modal" data-target="#add-game-modal" type="button"  ng-show="selectedPlatform" class="btn btn-block btn-success" id="button2">Add game...</button><div class="alert alert-info" ng-show="loadingGames" role="alert"> Loading games, please wait...</div><div class="alert alert-danger" ng-show="gamesErrorMessage" role="alert"><span class="glyphicon glyphicon-warning-sign"  aria-hidden="true" id="span7"></span> {{ gamesErrorMessage }}</div><div class="alert alert-info" ng-show="!gamesErrorMessage && !loadingGames && selectedPlatform == null" role="alert"><span class="glyphicon glyphicon-info-sign"  aria-hidden="true" id="span8"></span>Please select a platform to display your completed games</div><h2 ng-show="!gamesErrorMessage && !loadingGames && selectedPlatform">Completed {{ selectedPlatform.name }} games:</h2><div class="alert alert-warning" ng-show="!gamesErrorMessage && !loadingGames && selectedPlatform != null && games.length == 0" role="alert"><span class="glyphicon glyphicon-warning-sign"  aria-hidden="true" id="span9"></span>There are no games for the selected platform, please add your first game using the Add New Game Button</div><ul ng-show="selectedPlatform && games.length != 0" class="nav nav-pills nav-stacked"><li ng-repeat="game in games">{{ game.name }} ({{ game.completed }})</li></ul></div></div></div><script type="text/javascript">$(".form-modal").each(function(){var a=$(this);a.find("form").data("parent-modal",a)});$(".form-control").each(function(){var b=5;var a=$(this).parent();while(!a.hasClass("form-group")){a=a.parent();b--;if(b==0){break}}$(this).data("form-group",a)});var setFormControlError=function(a){if(!a||!a.data("form-group")){return}a.data("form-group").addClass("has-error")};var clearFormControlError=function(a){if(!a||!a.data("form-group")){return}a.data("form-group").removeClass("has-error")};var getProgress=function(a,b){return Math.floor((a*100)/b)};var validateForm=function(a){var b=true;a.find("input,select,textarea").each(function(){var d=$(this);var c=d.attr("data-required");c=(c=="false"||c=="0"?false:true);if((c&&!d.val()&&d.is(":visible"))||(d.attr("pattern")&&(!(new RegExp(d.attr("pattern")).test(d.val()))))||(d.attr("maxlength")&&d.val().length>parseInt(d.attr("maxlength")))||(d.attr("type")=="email"&&!(/@@/.test(d.val())))){b=false;setFormControlError($(this))}else{clearFormControlError($(this))}});return b};var serializeObject=function(c){var b=c.serializeArray();var e={};for(var d=0;d<b.length;d++){e[b[d].name]=b[d].value}return e};var blockElement=function(c,b,a){if(!c){return}c.each(function(){var d=$(this);d.data("origpos",d.css("position"));d.css("position","relative");var e=$('<div style="z-index: 1000; border: none; margin: 0px; padding: 0px; width: 100%; height: 100%; top: 0px; left: 0px;'+(b?("background-image: url('"+b+"');"):"")+'background-position: center; background-repeat: no-repeat; background-color: rgba(255,255,255,0.7); text-align: center; cursor: wait; position: absolute;"></div>');if(a){e.append(a)}d.append(e);d.data("overlay",e)})};var unblockElement=function(a){if(!a){return}a.each(function(){var b=$(this);if(!b.data("origpos")){return}b.css("position",b.data("origpos"));b.data("overlay").remove()})};var blockWindow=function(b,a){window.__ooverflow=$("body").css("overflow");$("body").css("overflow","hidden");var c=$('<div class="body-block-overlay" style="z-index: 2000; border: none; margin: 0px; padding: 0px; width: 100%; height: 100%; top: 0px; left: 0px;'+(b?("background-image: url('"+b+"');"):"")+'background-position: center; background-repeat: no-repeat; background-color: rgba(255,255,255,0.7); text-align: center; cursor: wait; position: fixed;"></div>');if(a){c.append(a)}$("body").append(c)};var unblockWindow=function(){$("body").css("overflow",window.__ooverflow);$(".body-block-overlay").remove()};var __currentTab=$('[data-toggle="tab"][aria-expanded="true"]');$('a[data-toggle="tab"]').on("shown.bs.tab",function(a){if($(this).data("onStart")){$(this).data("onStart")();$(this).data("onStart",null)}if($(this).data("onLoad")){$(this).data("onLoad")()}if(__currentTab){__currentTab.parent().removeClass("active");__currentTab.parent().parent().parent().removeClass("active")}__currentTab=$(a.target)});function updateQueryStringParam(d,a,e){var b=new RegExp("([?&])"+a+"=.*?(&|$)","i");var c=d.indexOf("?")!==-1?"&":"?";if(d.match(b)){return d.replace(b,"$1"+a+"="+e+"$2")}else{return d+c+a+"="+e}}function getQueryStringParam(d,a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(d);return c===null?null:decodeURIComponent(c[1].replace(/\+/g," "))}$.fn.disable=function(a){if(a){this.attr("_origHtml",this.html()).html(a)}this.each(function(){$(this).attr("disabled","disabled");return this})};$.fn.enable=function(){if(this.attr("_origHtml")){this.html(this.attr("_origHtml"))}this.each(function(){$(this).removeAttr("disabled");return this})};$.fn.ajaxGet=function(c,a,b){this.disable(b);callServerMethod(c,null,function(d){this.enable();a(d)}.bind(this))};$.fn.ajaxPost=function(e,c,b,a,d){this.disable(d);callServerMethod(e,null,function(f){this.enable();a(f)}.bind(this),"POST",c,b)};var __defaultLoadingImage="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH+GkNyZWF0ZWQgd2l0aCBhamF4bG9hZC5pbmZvACH5BAAKAAAAIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQACgABACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkEAAoAAgAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkEAAoAAwAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkEAAoABAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQACgAFACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQACgAGACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAAKAAcALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==";var callServerMethod=function(i,d,a,h,c,b){var g=[];if(d){for(var e in d){g.push(e+"="+d[e])}}var f=g.join("&");if(f){f=(i.indexOf("?")==-1?"?":"&")+f}$.ajax({cache:false,url:i+f,data:c||null,type:h||"GET",contentType:b||null,success:function(j,l,k){if(a){a({data:j,textStatus:l,jqXHR:k})}},error:function(l,m,k){var j=k?k:l.responseText;if(window.console){window.console.log("CallServerMethod Error "+i+" "+j)}if(a){a({error:j,textStatus:m,jqXHR:l})}}})};var __searchTimeout=null;$(".grid-search").keyup(function(){clearTimeout(__searchTimeout);__searchTimeout=setTimeout(function(){var a=$(this).closest("[data-source]");a.attr("data-source",updateQueryStringParam(a.attr("data-source"),"search",$(this).val()));refreshDataSource(a)}.bind(this),300)});$("[data-sortable]").each(function(){var d=$(this);var b=d.attr("data-order");b=b||"";if(b){var c=d.closest("[data-source]");var e=c.attr("data-source");var a=d.attr("data-sortable");e=updateQueryStringParam(e,"order",b);e=updateQueryStringParam(e,"sort",a);c.attr("data-source",e)}d.append('<div class="pull-right"><span style="visibility: '+(b=="asc"||b==""?"":"hidden")+'" class="glyphicon glyphicon-triangle-top sort-asc"></span><span style="visibility: '+(b=="desc"||b==""?"":"hidden")+'" class="glyphicon glyphicon-triangle-bottom sort-desc"></span></div>');d.data("order",b)}).click(function(){var d=$(this);var c=d.closest("[data-source]");var a=d.attr("data-sortable");var b=d.data("order");b=((b=="desc")?"asc":"desc");var e=c.attr("data-source");e=updateQueryStringParam(e,"order",b);e=updateQueryStringParam(e,"sort",a);c.attr("data-source",e);c.find(".sort-asc").css("visibility","");c.find(".sort-desc").css("visibility","");c.find("[data-sortable]").data("order","");d.data("order",b);if(b=="desc"){d.find(".sort-asc").css("visibility","hidden");d.find(".sort-desc").css("visibility","")}else{d.find(".sort-asc").css("visibility","");d.find(".sort-desc").css("visibility","hidden")}refreshDataSource(c)});var loadGridData=function(g,f,l){l=l||{};var b=g.find("th").length;var q=g.find("tbody");if(f.error){q.empty().append('<tr class="datagrid-error"><td colspan="'+b+'">ERROR</td></tr>');return}var m=g.find(".pagination");var r=f.data.total;var c=f.data.page;var p=f.data.rows;q.empty();m.empty();var n=getQueryStringParam(g.attr("data-source"),"rows")||10;var a=true;for(var h=0;h<n;h++){a=!a;var s=[];if(h<p.length){var o=p[h];try{if(l.onBeforeRowAdd){o=l.onBeforeRowAdd.bind(g)(p[h])}}catch(f){alert("Error onBeforeRowAdd: "+f);return}s.push('<tr class="datagrid-row '+(a?"datagrid-row-alt":"")+'">');for(var k=0;k<b;k++){if(o.id){s.push("<td>"+o.data[k]+"</td>")}else{s.push("<td>"+o[k]+"</td>")}}s.push("</tr>")}else{s.push('<tr class="datagrid-empty '+(a?"datagrid-row-alt":"datagrid-row")+'"><td colspan="'+b+'">-</td></tr>')}var t=$(s.join(""));t.data("row-data",p[h]);t.click(g,function(i){var j={elem:$(this),data:$(this).data("row-data")};if($(this).hasClass("datagrid-row")){i.data.data("selected-row",j);try{if(l.onRowClick){l.onRowClick.bind($(this))($(this).data("row-data"))}}catch(i){alert("Error onRowClick: "+i);return}}});q.append(t);try{if(l.onRowAdded){l.onRowAdded.bind($(t))(p[h])}}catch(f){alert("Error onRowAdded: "+f);return}}if(m.length>0&&r>0&&p.length>0){m.append('<li class="'+(c=="1"?"disabled":"")+'"><a href="#" data-page="-" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a></li>');m.append('<li class="pagination-first '+(c=="1"?"active":"")+'" style="'+((c>3&&r>7)?"":"display:none")+'"><a data-page="1" href="#"><span aria-hidden="true">1</span></a></li>');m.append('<li class="pagination-showleft" style="'+((c>4&&r>7)?"":"display:none")+'"><a href="#"><span aria-hidden="true">?</span></a></li>');m.find(".pagination-showleft a").click(function(){var v=m.find(".pagination-page a:visible");var e=m.find(".pagination-page");var i=parseInt($(v[0]).attr("data-page"))-1;var j=i-5;if(j<=0){j=0;i=5;m.find(".pagination-showleft").hide();m.find(".pagination-first").hide()}e.hide().slice(j,i).show();m.find(".pagination-showright").show();m.find(".pagination-last").show()});for(var h=0;h<r;h++){var d=Math.abs(c-(h+1));var u="display:none";if(r<=7){u=""}else{if(c<4&&d<6-c){u=""}else{if(c>=4&&d<3&&c<=r-4){u=""}else{if(c>r-4&&d<=c-(r-5)){u=""}}}}m.append('<li style="'+u+'" class="pagination-page '+(h+1==c?"active":"")+'"><a data-page='+(h+1)+' href="#">'+(h+1)+"</a></li>")}m.append('<li class="pagination-showright" style="'+((r>7&&c<=r-4)?"":"display:none")+'"><a href="#"><span aria-hidden="true">?</span></a></li>');m.append('<li class="pagination-last '+(c==r?"active":"")+'" style="'+((r>7&&c<=r-3)?"":"display:none")+'"><a data-page="'+r+'" href="#"><span aria-hidden="true">'+r+"</span></a></li>");m.find(".pagination-showright a").click(function(){var v=m.find(".pagination-page a:visible");var e=m.find(".pagination-page");var j=parseInt($(v[v.length-1]).attr("data-page"));var i=j+5;if(i>=e.length){i=e.length;j=i-5;m.find(".pagination-showright").hide();m.find(".pagination-last").hide()}e.hide().slice(j,i).show();m.find(".pagination-showleft").show();m.find(".pagination-first").show()});m.append('<li class="'+(c==r?"disabled":"")+'"><a href="#" data-page="+" aria-label="Next"><span aria-hidden="true">&raquo;</span></a></li>');m.find("a[data-page]").click(g,function(w){var i=$(this).attr("data-page");var x=c;if(i=="+"){if(c<r){x=c+1}}else{if(i=="-"){if(c>1){x=c-1}}else{m.find("li").removeClass("active");$(this).parent().addClass("active");x=parseInt(i)}}if(x!=c){try{if(l.onPageChanged){l.onPageChanged.bind(w.data)({current:c,next:x})}}catch(v){alert("Error onPageChanged: "+v);return}var j=w.data.attr("data-source");j=updateQueryStringParam(j,"page",x);j=updateQueryStringParam(j,"rows",n);w.data.data("selected-row",null);w.data.attr("data-source",j);refreshDataSource(w.data)}return false})}else{m.append('<li class="datagrid-noresults">'+l.noresultsLabel?l.noresultsLabel:"</li>")}try{if(l.onDataLoaded){l.onDataLoaded.bind(g)(f.data)}}catch(f){alert("Error onDataLoaded: "+f);return}};$('form[enctype!="multipart/form-data"]').submit(function(){var l=$(this);var k=l.data("parent-modal");var j=k?k.find(".modal-content"):null;var a=l.attr("data-ajax-submit");if(l.data("submitting")){return false}if(typeof _loadingImage==="undefined"){_loadingImage=__defaultLoadingImage}if(l.attr("data-block-image")){l.data("block-image",l.attr("data-block-image"))}else{l.data("block-image",_loadingImage)}if(l.attr("data-block-element")){l.data("block-element",$(l.attr("data-block-element")))}else{l.data("block-element",j?j:l)}if(!l.is("[novalidate]")){var g=l.data("invalid");if(!validateForm(l)){if(g){g()}return false}}if(!l.attr("action")){return false}var i=l.attr("method");var d=l.attr("enctype");i=i||"POST";d=d||"application/x-www-form-urlencoded";var e;var h=false;if(a){if(d=="application/json"||d=="text/json"){h=true;e=serializeObject(l)}else{e=l.serialize()}}var c=true;var b=l.data("beforeSubmit");if(b){try{c=b(a?e:serializeObject(l))}catch(f){alert("Error beforeSubmit: "+f)}}if(c===undefined){c=true}if(c){l.data("submitting",true);l.find("input,select,textarea").attr("readonly","readonly");blockElement(l.data("block-element"),l.data("block-image"));if(k){k.find(".server-error-message").remove()}if(!a){return true}callServerMethod(l.attr("action"),null,function(n){var p=$(this);unblockElement(p.data("block-element"));p.find("input,select,textarea").removeAttr("readonly");p.data("submitting",false);if(k){if(n.error){k.find(".modal-body").append('<div class="server-error-message alert alert-danger">'+(n.jqXHR.responseText?n.jqXHR.responseText:n.error)+"</div>")}else{k.modal("hide")}}if(!n.error){p[0].reset()}var m=p.data("afterSubmit");if(m){try{m(n)}catch(o){alert("Error afterSubmit: "+o)}}}.bind(this),i,h?JSON.stringify(e):e,d)}return false});var setElementValue=function(a,e){var c=$.isArray(e);if(a.is("select")){if(c){a.empty();for(var b=0;b<e.length;b++){if($.isPlainObject(e[b])){a.append('<option value="'+e[b].value+'">'+e[b].text+"</option>")}else{a.append("<option>"+e[b]+"</option>")}}}else{a.val(e)}}else{if(a.is("input")){var d=a.attr("type");if(d=="checkbox"||d=="radio"){a.prop("checked",e?true:false)}else{a.val(($.isPlainObject(e)?JSON.stringify(e):e))}}else{if(a.is("textarea")){if(c){a.val(e.join("\n"))}else{a.val(($.isPlainObject(e)?JSON.stringify(e):e))}}else{a.html(c?e.join("</br>"):($.isPlainObject(e)?JSON.stringify(e):e))}}}};var updateDataSource=function(b,c){var a=b.attr("data-source");if(!a){return}if(c){for(var d in c){a=updateQueryStringParam(a,d,c[d])}b.attr("data-source",a)}};var refreshDataSource=function(elem,newParams,callback){var dataSource=elem.attr("data-source");if(!dataSource){return}try{dataSource=eval(dataSource)}catch(e){}if(newParams){for(var prop in newParams){dataSource=updateQueryStringParam(dataSource,prop,newParams[prop])}elem.attr("data-source",dataSource)}if(elem.data("submitting")){return false}if(typeof _loadingImage==="undefined"){_loadingImage=__defaultLoadingImage}if(elem.attr("data-block-image")){elem.data("block-image",elem.attr("data-block-image"))}else{elem.data("block-image",_loadingImage)}if(elem.attr("data-block-element")){elem.data("block-element",$(elem.attr("data-block-element")))}else{elem.data("block-element",elem)}var beforeLoad=elem.data("beforeLoad");if(beforeLoad){try{beforeLoad()}catch(ex){alert("Error beforeLoad: "+ex)}}elem.data("submitting",true);blockElement(elem.data("block-element"),elem.data("block-image"));$('[data-source-id="'+elem.attr("id")+'"][data-bind]').each(function(){var self=$(this);self.attr("disabled","disabled").removeClass("error")});callServerMethod(dataSource,null,function(e){var self=$(this);e.elem=self;unblockElement(self.data("block-element"));self.data("submitting",false);var error=e.error?(e.jqXHR.responseText?e.jqXHR.responseText:e.error):null;if(!error){if(!$.isArray(e.data)){$('[data-source-id="'+self.attr("id")+'"][data-bind]').each(function(){var self=$(this);var dataBind=self.attr("data-bind");var v=dataBind?e.data[dataBind]:e.data;if(v===undefined){v=""}setElementValue(self.removeAttr("disabled"),v)})}else{if(self.is("select")){setElementValue(self.removeAttr("disabled"),e.data)}else{var row=$('[data-source-id="'+self.attr("id")+'"][data-bind]');if(row.length>0){if(row.attr("data-bind")){row=$(row[0]).parent()}else{row=$(row[0])}var rowHtml=$("<div></div>").append(row.clone()).html();var parentTable=row.parent();row.parent().empty();for(var i=0;i<e.data.length;i++){var newRow=$(rowHtml);newRow.find('[data-source-id="'+self.attr("id")+'"][data-bind]').each(function(){var self=$(this);var dataBind=self.attr("data-bind");var v=dataBind?e.data[i][dataBind]:e.data[i];if(v===undefined){v=""}setElementValue(self.removeAttr("disabled"),v)});parentTable.append(newRow)}}}}}if(error){$('[data-source-id="'+self.attr("id")+'"][data-bind]').each(function(){var self=$(this);setElementValue(self.addClass("error"),error)})}var afterLoad=self.data("afterLoad");if(afterLoad){try{afterLoad(e)}catch(ex){alert("Error afterLoad: "+ex)}}if(callback){callback(e)}}.bind(elem),elem.attr("data-method")?elem.attr("data-method"):"GET")};$('a[data-toggle="tab"]').click(function(a){if(a.originalEvent!==undefined&&window.history&&window.history.pushState){var b=$(this).attr("href");window.history.pushState(b,"",b)}setTimeout(function(){var c=$(this);$(c.attr("href")).find("[data-source]").each(function(e){var d=$(this);if(d.is(":visible")){refreshDataSource(d)}});if(c.attr("data-source")){refreshDataSource(c)}}.bind(this),200)});window.onpopstate=function(a){$('a[href="'+a.state+'"]').click()};$("ul.submenu a").on("shown.bs.tab",function(){$(this).parent().parent().closest("li").addClass("active")});app.controller("appCtrl",["$scope","$timeout","$http",function(b,c,a){b.platforms=[];b.games=[];b.itemsPerPage="3";b.selectedPlatform=null;b.currentPlatformPage=1;b.totalPlatformPages=1;b.platformSearchQuery="";b.pages=[];b.loadPlatforms=function(d){b.platforms=[];b.platformsErrorMessage="";b.loadingPlatforms=true;var f=[];if(b.platformSearchQuery){f.push("search="+b.platformSearchQuery)}if(d){f.push("page="+d)}if(b.itemsPerPage){f.push("items="+b.itemsPerPage)}var e=f.join("&");a({url:"/api/Platforms"+(e?("?"+e):""),method:"GET",}).then(function(h){b.currentPlatformPage=h.data.page;b.totalPlatformPages=h.data.total;b.platforms=h.data.platforms;b.loadingPlatforms=false;b.pages=[];for(var g=0;g<b.totalPlatformPages;g++){b.pages.push(g+1)}},function(g){b.platformsErrorMessage="An error has occurred while retrieving data from the server, please try again later.";b.platforms=[];b.loadingPlatforms=false})};b.nextPlatformPage=function(){if(b.currentPlatformPage<b.totalPlatformPages){b.currentPlatformPage++;b.loadPlatforms(b.currentPlatformPage)}};b.prevPlatformPage=function(){if(b.currentPlatformPage>1){b.currentPlatformPage--;b.loadPlatforms(b.currentPlatformPage)}};b.loadPlatforms(1);b.deletePlatform=function(d){window.location="/Platforms/Delete/"+d.id};b.getPlatformType=function(d){if(d=="1"){return"Handheld"}else{if(d=="2"){return"Computer/OS"}}return"Console"};b.editPlatform=function(d){window.location="/Platforms/Edit/"+d.id};b.loadGames=function(d,e){b.loadingGames=true;b.gamesErrorMessage="";if(e){b.selectedPlatform=e}a({url:"/api/Platforms/"+e.id,method:"GET",}).then(function(f){b.games=f.data;b.loadingGames=false},function(f){b.gamesErrorMessage="An error has occurred while retrieving data from the server, please try again later.";b.games=[];b.loadingGames=false})};b.setNewGameCompletedDate=function(d){b.newGame.completed=$("#newGameCompleted").val()};b.newGame={};b.addGame=function(){b.newGame.platformId=b.selectedPlatform.id;a({url:"/api/Games",data:JSON.stringify(b.newGame),method:"POST",}).then(function(d){b.games.push(angular.copy(b.newGame));b.newGame.name="";b.newGame.completed="";$("#add-game-modal").modal("hide")},function(d){alert("An error occurred while adding the new game. Please try again later.")})};b.searchPlatform=function(){b.loadPlatforms(1)}}]);$("#button1").click(function(a){window.location="/Platforms/Create"});$("#add-game-modal").on("shown.bs.modal",function(){$(this).find("[autofocus]").focus()});$("#newGameCompleted").datetimepicker({format:"MM/DD/YYYY"}).on("dp.change",function(){callAngularFunction("#appCtrl","setNewGameCompletedDate",$("#newGameCompleted").val())});var __hash=window.location.hash;var __hashTab=__hash?$('a[href="'+__hash+'"]'):null;if(__hashTab==null||__hashTab.length==0){__hashTab=$('a[data-toggle="tab"][aria-expanded="true"]:first');if(__hashTab.length>0){__hash=__hashTab.attr("href")}}if(window.history&&window.history.pushState&&__hash){window.history.pushState(__hash,"",__hash)}if(__hashTab!=null&&__hashTab.length>0){__hashTab.click();if(__hashTab.data("onStart")){__hashTab.data("onStart")()}}else{$("[data-source]").each(function(b){var a=$(this);if(a.is(":visible")){if(!a.attr("data-toggle")){refreshDataSource(a)}}})};</script></body></html>